<!doctype html>
<html lang="zh">
<head>
    <title>EC商城</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../Resource/css/styles.css">
    <link rel="stylesheet" type="text/css" href="../Resource/css/PROList.css"  />
	<link rel="stylesheet" type="text/css" href="../Resource/css/Car.css"  />
    <link rel="stylesheet" href="../Resource/css/flickity-docs.css" media="screen" />
</head>
<script src="../Resource/js/jquery-1.11.0.min.js" type="text/javascript"></script>
<script type="text/javascript">

    function init(){
        //載入header        
        $("#header").load( "Header.html");
        //載入footer
        $("#footer").load( "Footer.html");
        //取得商品分類
        getCate();
    }

    //取得商品分類
    function getCate(){    
        $.ajax({            
            method: "POST",
            url: "API/Category.php",
            data:{},            
            dataType: "json",
            success: function (response) {
                if(response != ""){
                    showCate(response);
                }                
            },
            error: function(exception) {
                alert("數據載入失敗: " + exception.status);
            }
        });
    }

    //顯示商品分類
    function showCate(response){
        $("#category").append(
            "<li></li>" +
            "<li><a href='Product.html'>所有商品</a></li>"
        );

        //更新html內容(透過jQuery跑迴圈取值)
        $.each(response, function(index, row) {
            $("#category").append(
                "<li><a href='Product.html?CID=" + row.ID + "'>" + row.Name + "</a></li>"
            );
        });

        $("#category").append(
            "<li><a href='Order.html'>我的消費紀錄</a></li>" +
            "<li class='point___mobi'><b><?=$showMemberText ?></b></li>"
        );
    }

    //------------------------------------------------------------------------

    function doSubmit() {
        if (document.getElementById('account').value == '') {
            alert("請填寫[帳號]");
            return false;
        }
        if (document.getElementById('pwd').value == '') {
            alert("請填寫[密碼]");
            return false;
        }        

        //AJAX送出表單內容
        $.ajax({            
            method: "POST",
            url: "API/login.php",
            data:{ 
                account: $("#account").val(),
                pwd: $("#pwd").val()
            },
            dataType: "text",
            success: function (response) {
                if(response == 'Y'){
                    //登入成功->導回產品頁
                    alert('登入成功');
                    location.href = 'Product.html';
                }else{
                    alert('帳號或密碼錯誤');
                }                
            },
            error: function(exception) {
                alert("發生錯誤: " + exception.status);
            }
        });
    }

</script>

<body onload="init()">

<div id="header"></div>

<div class="Car_">
	<div class="TOPtitle"></div>
	<table class="cart-item">
		<tr>
    		<td>
                <span>
                    帳號 <input type="text" id="account" name="account" value=""/><br>
                    密碼 <input type="password" id="pwd" name="pwd"  value=""/>
                </span>
            </td>								
        </tr>
	</table>
    <br />  
    <div>                  	
        <input type="button" class="sami _S_" value="加入會員" onclick="location.href='Join.html'">	
        <input type="button" class="sami _S_" value="登入" onclick="return doSubmit();">
    </div>
</div>

<div id="footer"></div>

</body>
</html>